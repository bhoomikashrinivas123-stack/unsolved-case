<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The Unsolved Case - Escape Room</title>

  <!-- ================= STYLES (UNCHANGED) ================= -->
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      color: #e0e0e0;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }
    .container {
      width: 100%;
      max-width: 1000px;
      background: #0f3460;
      border-radius: 12px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
      overflow: hidden;
      display: grid;
      grid-template-columns: 1fr 300px;
    }
    .main-content { padding: 40px; min-height: 600px; display: flex; flex-direction: column; }
    .sidebar { background: #0a1e35; padding: 30px 20px; border-left: 2px solid #e94560; }
    header { margin-bottom: 30px; border-bottom: 2px solid #e94560; padding-bottom: 15px; }
    h1 { color: #e94560; font-size: 28px; }
    .room-title { color: #16c784; font-size: 18px; }
    .clue-image { cursor:pointer; }
    .message.success { color:#16c784; }
    .message.error { color:#e94560; }
  </style>
</head>

<body>

<div class="container" id="gameContainer">
  <div class="main-content">
    <header>
      <h1>üîç The Unsolved Case</h1>
      <p class="room-title" id="roomTitle"></p>
      <p>Room: <span id="roomNumber"></span> | Hints Used: <span id="hintsUsed">0</span></p>
    </header>
    <div id="roomContent"></div>
  </div>

  <div class="sidebar">
    <h3>Evidence</h3>
    <div id="evidenceList"></div>
  </div>
</div>

<!-- ================= IMAGE MODAL ================= -->
<div id="imageModal" style="display:none;">
  <div>
    <button onclick="closeImageModal()">X</button>
    <div id="modalImage"></div>
    <div id="modalDescription"></div>
  </div>
</div>

<script>
/* ================= GAME STATE ================= */

const gameState = {
  currentRoom: 0,
  hintsUsed: 0,
  solvedRooms: new Set(),
  collectedEvidence: new Set(),
  cooldownInterval: null,
  cooldownRemaining: 0
};

/* ================= ROOMS ================= */

const rooms = [
  {
    title: "Room 1: The Crime Scene",
    story: "A precious diamond has been stolen from the museum.",
    visualClues: [
      { emoji:"üìù", label:"Note Found", description:"Meet at 1_:3_" },
      { emoji:"üïê", label:"Clock", description:"Clock shows 3:30 PM" }
    ],
    puzzle: {
      question: "What time was the diamond stolen? (HH:MM)",
      answer: "15:30",

      /* ‚úÖ CHANGED HINT */
      hint: "Check the clock and the note carefully, and remember to use the 24-hour format."
    },
    evidence: "Security Log"
  },
  {
    title: "Room 2: Suspect Interrogation",
    story: "Three suspects give statements.",
    visualClues: [
      { emoji:"üë®", label:"Alex", description:"Diamond dealer" },
      { emoji:"üëÆ", label:"Ben", description:"Security guard" },
      { emoji:"üë©", label:"Clara", description:"Museum curator" }
    ],
    puzzle: {
      question: "Who is lying? (Alex, Ben, Clara)",
      answer: "clara",
      hint: "Phone records contradict one statement."
    },
    evidence: "Phone Records"
  },
  {
    title: "Room 3: Final Code",
    story: "Unlock the vault.",
    visualClues: [
      { emoji:"üèõ", label:"1", description:"One pillar" },
      { emoji:"‚≠ê", label:"5", description:"Five stars" },
      { emoji:"üî∫", label:"3", description:"Three barriers" },
      { emoji:"üîê", label:"0", description:"Zero lock" }
    ],
    puzzle: {
      question: "Enter 4-digit code",
      answer: "1530",
      hint: "Time without colon."
    },
    evidence: "Confession"
  }
];

/* ================= GAME FUNCTIONS ================= */

function loadRoom() {
  const room = rooms[gameState.currentRoom];
  document.getElementById("roomTitle").textContent = room.title;
  document.getElementById("roomNumber").textContent =
    `${gameState.currentRoom + 1}/${rooms.length}`;

  document.getElementById("roomContent").innerHTML = `
    <p>${room.story}</p>
    <div>
      ${room.visualClues.map((c,i)=>`
        <div class="clue-image" onclick="openImageModal(${i})">
          ${c.emoji} ${c.label}
        </div>`).join("")}
    </div>
    <p>${room.puzzle.question}</p>
    <input id="answerInput">
    <button onclick="submitAnswer()">Submit</button>
    <button onclick="useHint()">Use Hint</button>
    <div id="message"></div>
  `;
}

function submitAnswer() {
  const input = document.getElementById("answerInput");
  const msg = document.getElementById("message");
  const answer = input.value.trim().toLowerCase();
  const correct = rooms[gameState.currentRoom].puzzle.answer;

  if (answer === correct) {
    msg.className = "message success";
    msg.textContent = "‚úÖ Correct!";
    gameState.collectedEvidence.add(rooms[gameState.currentRoom].evidence);
    gameState.currentRoom++;
    if (gameState.currentRoom < rooms.length) {
      setTimeout(loadRoom, 1000);
    } else {
      msg.textContent = "üèÜ Case Closed!";
    }
  } else {
    msg.className = "message error";
    msg.textContent = "‚ùå Incorrect ‚Äî try again in 30s.";
    input.disabled = true;

    /* ‚úÖ COOLDOWN CHANGED TO 30s */
    gameState.cooldownRemaining = 30;
    gameState.cooldownInterval = setInterval(() => {
      gameState.cooldownRemaining--;
      msg.textContent = `‚ùå Incorrect ‚Äî try again in ${gameState.cooldownRemaining}s`;
      if (gameState.cooldownRemaining <= 0) {
        clearInterval(gameState.cooldownInterval);
        input.disabled = false;
        msg.textContent = "You can try again now.";
      }
    }, 1000);
  }
}

function useHint() {
  gameState.hintsUsed++;
  document.getElementById("hintsUsed").textContent = gameState.hintsUsed;
  document.getElementById("message").textContent =
    rooms[gameState.currentRoom].puzzle.hint;
}

function openImageModal(i) {
  const clue = rooms[gameState.currentRoom].visualClues[i];
  document.getElementById("modalImage").textContent = clue.emoji;
  document.getElementById("modalDescription").textContent = clue.description;
  document.getElementById("imageModal").style.display = "block";
}

function closeImageModal() {
  document.getElementById("imageModal").style.display = "none";
}

/* ================= INIT ================= */
loadRoom();
</script>

</body>
</html>
